# Clip to Notion - 選択テキスト保存アプリ

macOSメニューバーに常駐し、選択したテキストをホットキー一発でNotionに保存するシンプルなアプリケーションです。

## 機能

- **ホットキー保存**: `Cmd+Shift+N` で選択テキストを即座にNotionに保存
- **メニューバー常駐**: 邪魔にならず、必要な時だけ使える
- **シンプル**: ポップアップなし、入力不要、ワンアクションで完了

## 必要な環境

- **macOS** (このバージョンはmacOS専用です)
- Python 3.11以上
- Notionアカウント

## セットアップ手順

### 1. Notionの設定

#### 統合を作成

1. [Notion Integrations](https://www.notion.so/my-integrations) にアクセス
2. 「+ New integration」をクリック
3. 名前を入力し、「Internal Integration」を選択
4. 「Submit」をクリックし、「Internal Integration Secret」をコピー

#### データベースを作成

1. Notionで新しいページを作成
2. データベース（テーブル）を追加
3. デフォルトの「Name」プロパティのみでOK（他のプロパティは不要）

#### 統合をデータベースに接続

1. データベースページの右上「...」メニューをクリック
2. 「接続を追加」を選択
3. 作成した統合を選択

#### データベースIDを取得

1. データベースページを開く
2. URLをコピー: `https://notion.so/[ワークスペース]/[DATABASE_ID]?v=...`
3. URLの中の32文字の英数字（DATABASE_ID部分）をメモ

### 2. ローカル環境のセットアップ

#### 依存関係をインストール

```bash
pip install -r requirements.txt
```

#### 環境変数を設定

`.env.example`をコピーして`.env`を作成:

```bash
cp .env.example .env
```

`.env`ファイルを編集:

```
NOTION_API_KEY=your_notion_api_key_here
NOTION_DATABASE_ID=your_database_id_here
```

**または**、環境変数を直接設定:

```bash
export NOTION_API_KEY="your_notion_api_key_here"
export NOTION_DATABASE_ID="your_database_id_here"
```

### 3. アプリケーションの起動

```bash
python main.py
```

成功すると以下のように表示され、メニューバーにアイコン（📋）が表示されます:

```
✓ Notion接続成功: [あなたのデータベース名]

==================================================
Clip to Notion - 起動完了
==================================================
使い方:
1. テキストを選択
2. Cmd+Shift+N を押す
3. Notionに保存されます

終了: メニューバーアイコンから「終了」を選択
==================================================
```

## 使い方

1. アプリケーションを起動（メニューバーにアイコンが表示される）
2. 任意のアプリでテキストを選択
3. `Cmd+Shift+N` を押す
4. → 自動的にNotionに保存されます
5. コンソールに保存完了メッセージが表示されます

### Notionに保存される内容

- **タイトル**: タイムスタンプ（例: `2025-10-14 15:30:45`）
- **本文**: 選択したテキスト全文

### 終了方法

- メニューバーのアイコン（📋）をクリック → 「終了」を選択
- または、ターミナルで `Ctrl+C`

## ファイル構成

```
.
├── main.py              # メインアプリケーション（メニューバー + ホットキー）
├── notion_api.py        # Notion API連携
├── requirements.txt     # Python依存パッケージ
├── .env.example        # 環境変数のサンプル
└── README.md           # このファイル
```

## トラブルシューティング

### Notion接続エラー

**エラー**: `Could not find database with ID`

**解決方法**:
1. データベースIDが正しいか確認
2. 統合がデータベースに接続されているか確認
3. Notion APIキーが正しいか確認

### ホットキーが動作しない

**解決方法**:
1. macOSの「システム設定」→「プライバシーとセキュリティ」→「アクセシビリティ」でターミナル（またはアプリ）を許可
2. 他のアプリで同じホットキーが使われていないか確認

### 選択テキストが取得できない

**解決方法**:
1. テキストを選択した状態で `Cmd+Shift+N` を押す
2. アクセシビリティ権限が付与されているか確認

## 依存パッケージ

- **pyperclip** (1.11.0): クリップボード操作
- **notion-client** (2.5.0): Notion API
- **rumps** (0.4.0): macOSメニューバーアプリ
- **pynput** (1.7.6): グローバルホットキー

## ライセンス

このプロジェクトはMITライセンスの下で公開されています。

## 変更履歴

### v2.0 (2025-10-14)
- メニューバー常駐アプリに変更
- ホットキー（Cmd+Shift+N）で選択テキストを保存
- ポップアップUIを削除（シンプル化）
- タイトルとタグの入力を廃止
- タイムスタンプを自動タイトルとして使用
