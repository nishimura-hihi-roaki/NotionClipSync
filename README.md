# Clip to Notion - クリップボード保存アプリ

macOSメニューバーに常駐し、クリップボードの内容をホットキー一発でNotionに保存するシンプルなアプリケーションです。

## 機能

- **ホットキー保存**: デフォルトで `⌘⇧V` でクリップボードの内容を即座にNotionに保存
- **メニューバー常駐**: 邪魔にならず、必要な時だけ使える
- **シンプル**: ポップアップなし、入力不要、ワンアクションで完了
- **カスタマイズ可能**: ショートカットキーを変更可能

## 必要な環境

- **macOS** (このバージョンはmacOS専用です)
- Python 3.11以上
- Notionアカウント

## セットアップ手順

### 1. Notionの設定

#### 統合を作成

1. [Notion Integrations](https://www.notion.so/my-integrations) にアクセス
2. 「+ New integration」をクリック
3. 名前を入力し、「Internal Integration」を選択
4. 「Submit」をクリックし、「Internal Integration Secret」をコピー

#### データベースを作成

1. Notionで新しいページを作成
2. データベース（テーブル）を追加
3. 以下のプロパティを設定:
   - **1つ目**: タイトルプロパティ（デフォルトで存在、名前は何でもOK）- 日付が入ります
   - **2つ目**: 「メモ」という名前のテキストプロパティを追加 - コピーした内容が入ります

#### 統合をデータベースに接続

1. データベースページの右上「...」メニューをクリック
2. 「接続を追加」を選択
3. 作成した統合を選択

#### データベースIDを取得

1. データベースページを開く
2. URLをコピー: `https://notion.so/[ワークスペース]/[DATABASE_ID]?v=...`
3. URLの中の32文字の英数字（DATABASE_ID部分）をメモ

### 2. ローカル環境のセットアップ

#### 依存関係をインストール

```bash
pip install -r requirements.txt
```

### 3. アプリケーションの起動

```bash
python main.py
```

初回起動時は自動的に設定画面が表示されます。以下の情報を入力してください:

1. **Notion API Key**: 統合を作成した際にコピーしたシークレット
2. **Database ID**: データベースのURLから取得した32文字の英数字
3. **ショートカットキー**: お好みのキーを選択（デフォルト: `⌘⇧V`）

「接続テスト」ボタンで接続を確認後、「保存して起動」をクリックします。

成功すると以下のように表示され、メニューバーにアイコン（📋）が表示されます:

```
✓ Notion接続成功: [あなたのデータベース名]

==================================================
Clip to Notion - 起動完了
==================================================
使い方:
1. テキストを選択して ⌘+C でコピー
2. ⌘⇧V を押す
3. Notionに保存されます

終了: メニューバーアイコンから「終了」を選択
==================================================
```

## 使い方

1. アプリケーションを起動（メニューバーにアイコンが表示される）
2. 任意のアプリでテキストを選択
3. `⌘+C` でコピー
4. `⌘⇧V`（またはカスタマイズしたショートカット）を押す
5. → 自動的にNotionに保存されます
6. コンソールに保存完了メッセージが表示されます

### Notionに保存される内容

- **日付列（タイトル）**: タイムスタンプ（例: `2025-10-17 15:30:45`）
- **メモ列**: コピーしたテキスト全文

### 設定の変更

メニューバーのアイコン（📋）をクリック → 「設定を変更」を選択

変更可能な項目:
- Notion API Key
- Database ID
- ショートカットキー（`⌘⇧V`、`⌘⌃⇧V`、`⌘⌥V`、`⌘⇧N`から選択）

設定変更後はアプリの再起動が必要です。

### 終了方法

- メニューバーのアイコン（📋）をクリック → 「終了」を選択
- または、ターミナルで `Ctrl+C`

## ファイル構成

```
.
├── main.py              # メインアプリケーション（メニューバー + ホットキー）
├── notion_api.py        # Notion API連携
├── setup_gui.py         # 設定画面GUI
├── setup_launcher.py    # 設定画面ランチャー
├── requirements.txt     # Python依存パッケージ
├── .env.example         # 環境変数のサンプル
└── README.md            # このファイル
```

## 設定ファイルの保存場所

設定ファイルは以下の場所に保存されます:

```
~/.clip_to_notion/.env
```

（`~`はユーザーのホームディレクトリ）

## トラブルシューティング

### Notion接続エラー

**エラー**: `Could not find database with ID`

**解決方法**:
1. データベースIDが正しいか確認
2. 統合がデータベースに接続されているか確認
3. Notion APIキーが正しいか確認

### データベースに「メモ」プロパティが見つからない

**エラー**: プロパティ関連のエラー

**解決方法**:
1. Notionデータベースに「メモ」という名前のテキストプロパティを追加
2. プロパティ名は正確に「メモ」である必要があります（大文字小文字を含む）

### ホットキーが動作しない

**解決方法**:
1. 他のアプリで同じホットキーが使われていないか確認
2. 設定画面で別のショートカットキーに変更してみる
3. アプリを再起動する

### クリップボードが空と表示される

**解決方法**:
1. テキストを選択した状態で `⌘+C` でコピーしてから `⌘⇧V` を押す
2. コピー操作が正常に完了しているか確認

## 依存パッケージ

- **pyperclip** (1.11.0): クリップボード操作
- **notion-client** (2.5.0): Notion API
- **rumps** (0.4.0): macOSメニューバーアプリ
- **pynput** (1.7.6): グローバルホットキー
- **python-dotenv** (1.0.0): 環境変数管理

## ライセンス

このプロジェクトはMITライセンスの下で公開されています。

## 変更履歴

### v3.0 (2025-10-17)
- クリップボードから直接テキストを取得する方式に変更
- アクセシビリティ権限が不要に
- より確実な動作を実現

### v2.0 (2025-10-14)
- メニューバー常駐アプリに変更
- ホットキー（Cmd+Shift+N）で選択テキストを保存
- ポップアップUIを削除（シンプル化）
- タイトルとタグの入力を廃止
- タイムスタンプを自動タイトルとして使用
